{
    "app-id": "org.scarlett.ScarlettOS",
    "runtime": "org.gnome.Platform",
    "command": "/usr/bin/sh",
    "sdk": "org.gnome.Sdk",
    "runtime-version": "3.24",
    "tags": ["nightly"],
    "desktop-file-name-prefix": "(Nightly) ",
    "copy-icon": true,
    "finish-args": [
        /* Allow access to developer tools */
        "--allow=devel",
        "--talk-name=org.freedesktop.Flatpak",
        /* X11 + XShm access */
        "--socket=x11",
        "--share=ipc",
        /* Wayland access */
        "--socket=wayland",
        /* Needs to talk to the network: */
        "--share=network",
        "--own-name=org.scarlett.Listener",
        "--own-name=org.scarlett.Listener.*",
        "--talk-name=org.freedesktop.secrets",
        "--talk-name=org.freedesktop.DBus.Proprieties",
        "--talk-name=org.freedesktop.IBus",
        "--talk-name=org.freedesktop.Notifications",
        /* Pulseaudio */
        "--socket=pulseaudio",
        "--device=dri",
        "--talk-name=org.gtk.vfs.*",
        "--socket=session-bus",
        "--filesystem=host",
        "--system-talk-name=org.freedesktop.Avahi",
        "--talk-name=org.freedesktop.secrets",
        "--filesystem=xdg-run/keyring",
        "--env=SSL_CERT_DIR=/etc/ssl/certs",
        "--filesystem=/etc/ssl:ro",
        "--filesystem=/etc/pki:ro",
        "--filesystem=/etc/ca-certificates:ro",
        "--filesystem=~/.local/share/flatpak",
        "--filesystem=/var/lib/flatpak",
        "--filesystem=xdg-run/dconf",
        "--filesystem=~/.config/dconf:ro",
        "--talk-name=ca.desrt.dconf",
        "--env=DCONF_USER_CONFIG_DIR=.config/dconf"
    ],
    "build-options": {
        "cflags": "-O2 -g",
        "cxxflags": "-O2 -g",
        "env": {
            "V": "1"
        }
    },
    "modules": [
        {
            "name": "cpython",
            "post-install": [
                /* These are needed for the triggers */
                "ls -lta `pwd`",
                "/app/bin/python3 -m pip install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} pip setuptools wheel"
            ],
            "build-options": {
                /* This is an array containing extra options to pass to flatpak build. */
                "build-args": [
                    "--share=network",
                    "--allow=devel"
                ],
                /* This is an array containing extra options to pass to configure. */
                "config-opts": [
                    "--with-pydebug"
                ],
                /* This is set in the environment variable CFLAGS during the build. Multiple specifications of this (in e.g. per-arch area) are concatenated, separated by spaces. */
                "cflags": "-O0 -g",
                /* This is set in the environment variable CXXFLAGS during the build. Multiple specifications of this (in e.g. per-arch area) are concatenated, separated by spaces. */
                "cxxflags": "-O0 -g",
                /* If this is true (the default is false) then all ELF files will be stripped after install. */
                "strip": false,
                /* By default (if strip is not true) flatpak-builder extracts all debug info in ELF files to a separate files and puts this in an extension. If you want to disable this, set no-debuginfo to true. */
                "no-debuginfo": false
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.python.org/ftp/python/3.5.2/Python-3.5.2.tar.xz",
                    "sha256": "0010f56100b9b74259ebcd5d4b295a32324b58b517403a10d1a2aa7cb22bca40"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/ae/e8/2340d46ecadb1692a1e455f13f75e596d4eab3d11a57446f08259dee8f02/pip-10.0.1.tar.gz",
                    "sha256": "f2bd08e0cd1b06e10218feaf6fef299f473ba706582eb3bd9d52203fdbd7ee68"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/a6/5b/f399fcffb9128d642387133dc3aa9bb81f127b949cd4d9f63e5602ad1d71/setuptools-39.1.0.zip",
                    "sha256": "c5484e13b89927b44fd15897f7ce19dded8e7f035466a4fa7b946c0bdd86edd7"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/5d/c1/45947333669b31bc6b4933308dd07c2aa2fedcec0a95b14eedae993bd449/wheel-0.31.0.tar.gz",
                    "sha256": "1ae8153bed701cb062913b72429bcf854ba824f973735427681882a688cb55ce"
                }
            ]
        },

        {
            "name": "numpy3",
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3"
                }
            },
            "buildsystem": "simple",
            "build-commands": [
                "python3 ./setup.py sdist",
                "pip3 install dist/*.tar.gz"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://pypi.python.org/packages/05/84/0feb999c05f252af50a5fbc463268044feda92cdaad8cb0d0a6073d76057/numpy-1.13.0.zip#md5=fd044f0b8079abeaf5e6d2e93b2c1d03",
                    "sha256": "dcff367b725586830ff0e20b805c7654c876c2d4585c0834a6049502b9d6cf7e"
                }
            ]
        },

        {
            "name": "meson",
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3"
                }
            },
            "buildsystem": "simple",
            "build-commands": [
                "python3 ./setup.py sdist",
                "pip3 install dist/*.tar.gz"
            ],
            "sources": [
                {
                    "type": "git",
                    "branch": "0.46.0",
                    "url": "https://github.com/mesonbuild/meson"
                }
            ]
        },

        {
            "name": "gtk-doc-git",
            "disabled": true,
            "config-opts": [
                "--enable-compile-warnings=minimum"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "git",
                    "branch": "master",
                    "url": "https://github.com/GNOME/gtk-doc.git"
                }
            ]
        },

        {
            "name": "glib-git",
            "config-opts": [
                "--with-pcre=system",
                "--with-python=python3"
            ],
            "ensure-writable": [
                "/share/glib-2.0/codegen/*.pyc"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "git",
                    "branch": "eaca4f4116801f99e30e42a857559e19a1e6f4ce",
                    "url": "https://github.com/GNOME/glib.git"
                }
            ]
        },

        {
            "name": "gobject-introspection-git",
            "config-opts": [
                "--disable-static"
            ],
            "ensure-writable": [
                "/lib/*/gobject-introspection/giscanner/*.pyc",
                "/lib/*/gobject-introspection/giscanner/*/*.pyc"
            ],
            "_cleanup-platform": [
                "/lib/*/gobject-introspection/giscanner",
                "/share/gobject-introspection/giscanner",
                "/bin"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "git",
                    "branch": "cee2a4f215d5edf2e27b9964d3cfcb28a9d4941c",
                    "url": "https://github.com/GNOME/gobject-introspection.git"
                }
            ]
        },

        {
            "name": "pycairo",
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3"
                }
            },
            "buildsystem": "simple",
            "build-commands": [
                "python3 ./setup.py sdist",
                "pip3 install dist/*.tar.gz"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/pygobject/pycairo/releases/download/v1.14.1/pycairo-1.14.1.tar.gz",
                    "sha256": "0d13a0a6eeaf0c357db04392943eb9b25767445608d31dde1307f003f68c5754"
                }
            ]
        },

        {
            "name": "pygobject-git",
            "config-opts": [
                "--enable-compile-warnings=minimum",
                "--with-python=/app/bin/python3"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "git",
                    "branch": "fb1b8fa8a67f2c7ea7ad4b53076496a8f2b4afdb",
                    "url": "https://github.com/GNOME/pygobject.git"
                }
            ]
        },

        {
            "name": "gstreamer-1.8.2",
            "config-opts": [
                "--enable-debug",
                "--disable-examples",
                "--disable-fatal-warnings",
                "--enable-doc-installation=no"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "build-commands": [
                /* We delete all the overlapping freedesktop SDK plugins to avoid version mismatches with renamed or removed plugins */
                "rm -rf /usr/lib/*/gstreamer-1.0"
            ],
            "sources": [
                {
                    "type": "archive",
                    "sha256": "9dbebe079c2ab2004ef7f2649fa317cabea1feb4fb5605c24d40744b90918341",
                    "url": "https://gstreamer.freedesktop.org/src/gstreamer/gstreamer-1.8.2.tar.xz"
                }
            ]
        },


       {
            "name": "orc-0.4.25",
            "config-opts": ["--disable-static"],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "sha256": "c1b1d54a58f26d483f0b3881538984789fe5d5460ab8fab74a1cacbd3d1c53d1",
                    "url": "https://gstreamer.freedesktop.org/src/orc/orc-0.4.25.tar.xz"
                }
            ]
        },

        {
            "name": "gst-plugins-base",
            "config-opts": [
                "--enable-experimental",
                "--enable-orc",
                "--disable-fatal-warnings"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "sha256": "9d7109c8fb0a5dec8edb17b0053c59a46aba7ddf48dc48ea822ebbbd4339d38d",
                    "url": "http://gstreamer.freedesktop.org/src/gst-plugins-base/gst-plugins-base-1.8.2.tar.xz"
                }
            ]
        },

        {
            "name": "gst-plugins-good",
            "config-opts": [
                "--enable-experimental",
                "--enable-orc",
                "--disable-monoscope",
                "--disable-aalib",
                "--enable-cairo",
                "--disable-libcaca",
                "--disable-jack",
                "--with-default-visualizer=autoaudiosink",
                "--disable-fatal-warnings"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "sha256": "8d7549118a3b7a009ece6bb38a05b66709c551d32d2adfd89eded4d1d7a23944",
                    "url": "http://gstreamer.freedesktop.org/src/gst-plugins-good/gst-plugins-good-1.8.2.tar.xz"
                }
            ]
        },

        {
            "name": "gst-plugins-bad",
            "config-opts": [
                "--enable-experimental",
                "--enable-orc",
                "--disable-fatal-warnings"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "sha256": "d7995317530c8773ec088f94d9320909d41da61996b801ebacce9a56af493f97",
                    "url": "http://gstreamer.freedesktop.org/src/gst-plugins-bad/gst-plugins-bad-1.8.2.tar.xz"
                }
            ]
        },

        {
            "name": "gst-plugins-ugly",
            "config-opts": [
                "--enable-experimental",
                "--enable-orc",
                "--disable-fatal-warnings"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "sha256": "9c5b33a2a98fc1d6d6c99a1b536b1fb2de45f53cc8bf8ab85a8b8141fed1a8ac",
                    "url": "http://gstreamer.freedesktop.org/src/gst-plugins-ugly/gst-plugins-ugly-1.8.2.tar.xz"
                }
            ]
        },


        {
            "name": "gst-libav",
            "config-opts": ["--with-system-libav", "--disable-fatal-warnings" ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "sha256": "b5f3c7a27b39b5f5c2f0bfd546b0c655020faf6b38d27b64b346c43e5ebf687a",
                    "url": "http://gstreamer.freedesktop.org/src/gst-libav/gst-libav-1.8.2.tar.xz"
                }
            ]
        },

        {
          "name": "portaudio",
          "_comment": "https://github.com/flathub/net.ankiweb.Anki/blob/b62bc0fea594df26fafd112d7d809cdb8782fa91/net.ankiweb.Anki.json",
          "sources": [
              {
                  "type": "archive",
                  "url": "http://www.portaudio.com/archives/pa_stable_v190600_20161030.tgz",
                  "sha256": "f5a21d7dcd6ee84397446fa1fa1a0675bb2e8a4a6dceb4305a8404698d8d1513"
              }
          ]
        },

        {
          "name": "pcaudiolib",
          "sources": [
              {
                  "type": "git",
                  "branch": "d6a6b00aa4334b461c1a09c27b6c681eaac8da8a",
                  "url": "https://github.com/rhdunn/pcaudiolib.git"
              }
          ]
        },

        {
            "name": "pulseaudio",
            "config-opts": [
                "--disable-static",
                "--disable-rpath",
                "--with-system-user=pulse",
                "--with-system-group=pulse",
                "--with-access-group=pulse-access",
                "--disable-oss-output",
                "--disable-jack",
                "--disable-lirc",
                "--disable-bluez4",
                "--disable-bluez5",
                "--disable-systemd"
            ],
            "_cleanup": [
                "/share/pulseaudio",
                "/bin/pulseaudio",
                "/bin/start-pulseaudio-x11",
                "/bin/pasuspender",
                "/lib/pulse-*/modules",
                "/etc/dbus-1/system.d",
                "/etc/pulse/daemon.conf",
                "/etc/pulse/*.pa"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "http://www.freedesktop.org/software/pulseaudio/releases/pulseaudio-10.0.tar.xz",
                    "sha256": "a3186824de9f0d2095ded5d0d0db0405dc73133983c2fbb37291547e37462f57"
                }
            ]
        },

        {
            "name": "alsa-lib",
            "config-opts": [
                "--disable-aload",
                "--disable-alisp",
                "--disable-old-symbols",
                "--with-pcm-plugins=hw ioplug extplug"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://people.freedesktop.org/~alexl/alsa-lib-1.1.4.1.tar.bz2",
                    "sha256": "91bb870c14d1c7c269213285eeed874fa3d28112077db061a3af8010d0885b76"
                },
                {
                    "type": "script",
                    "dest-filename": "autogen.sh",
                    "commands": [
                        "autoreconf -i"
                    ]
                },
                {
                    "type": "patch",
                    "path": "alsa-lib-plugin-path.patch"
                }
            ]
        },
        {
            "name": "alsa-plugins",
            "config-opts": [
                "--disable-jack",
                "--enable-pulseaudio",
                "--disable-samplerate",
                "--disable-avcodec",
                "--with-speex=no"
            ],
            "post-install": [
                "mv /app/share/alsa/alsa.conf.d/99-pulseaudio-default.conf.example /app/share/alsa/alsa.conf.d/99-pulseaudio-default.conf"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://people.freedesktop.org/~alexl/alsa-plugins-1.1.4.tar.bz2",
                    "sha256": "530d1c3bdaeb058f2a03607a33b9e16ee5369bfd30a96bc09bd2c69b4ddd1a8a"
                },
                {
                    "type": "script",
                    "dest-filename": "autogen.sh",
                    "commands": [
                        "autoreconf -i"
                    ]
                }
            ]
        },

        {
            "name": "espeak",
            "buildsystem": "simple",
            "build-commands": [
                "./autogen.sh --prefix=/app",
                "cat ./configure",
                "sleep 10",
                "./configure --prefix=/app",
                "make",
                "make install"
            ],
            "make-args": [
                "LIBDIR=/app/lib",
                "ESPEAK_DATA_PATH=/app/usr/share/espeak-ng-data"
            ],
            "make-install-args": [
                "LIBDIR=/app/lib",
                "ESPEAK_DATA_PATH=/app/usr/share/espeak-ng-data"
            ],
            "build-options": {
                /* This is an array containing extra options to pass to flatpak build. */
                "build-args": [
                    "--share=network",
                    "--allow=devel"
                ],
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app",
                    "ESPEAK_DATA_PATH": "/app/usr/share/espeak-ng-data",
                    "LIBDIR": "/app/lib"
                },
                /* If this is true (the default is false) then all ELF files will be stripped after install. */
                "strip": false,
                /* By default (if strip is not true) flatpak-builder extracts all debug info in ELF files to a separate files and puts this in an extension. If you want to disable this, set no-debuginfo to true. */
                "no-debuginfo": false
            },
            "sources": [
                {
                    "type": "git",
                    "branch": "1.49.2",
                    "url": "https://github.com/rhdunn/espeak.git"
                }
            ]
        },

        {
            "name": "gst-plugins-espeak",
            "buildsystem": "simple",
            "build-commands": [
                "./configure --prefix=/app",
                "cat ./configure",
                "sleep 10",
                "make",
                "make install"
            ],
            "ensure-writable": [
                "easy-install.pth"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app",
                    "GST_MAJORMINOR": "1.0",
                    "ESPEAK_PREFIX": "/app"
                },
                "cxxflags": "-g -O2 -fstack-protector-strong -Wformat -Werror=format-security -g -O2 -fstack-protector-strong -Wformat -Werror=format-security"
            },
            "sources": [
                {
                    "type": "archive",
                    "sha256": "f87c6c92338130a9e6a763d217a8e0d666206ec7b277fbe9fecb774db1b0d908",
                    "url": "https://github.com/bossjones/bossjones-gst-plugins-espeak-0-4-0/archive/v0.4.1.tar.gz"
                },
                {
                    "type": "patch",
                    "path": "bossjones-gst-plugins-espeak.patch"
                }
            ]
        },

        {
            "name": "python-gstreamer",
            "ensure-writable": [
                "easy-install.pth"
            ],
            "disabled": true,
            "build-options": {
                "env": {
                    "PYTHON": "/usr/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "git",
                    "branch": "1c6a57b0d1f8b3f16d67a8cdb39bafc22c7b3b51",
                    "url": "https://github.com/GStreamer/gst-python.git"
                }
            ]
        },

        {
            "name": "pyxdg",
            "ensure-writable": [
                "easy-install.pth"
            ],
            "buildsystem": "simple",
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "git",
                    "branch": "7db14dcf4c4305c3859a2d9fcf9f5da2db328330",
                    "url": "https://github.com/takluyver/pyxdg.git"
                }
            ],
            "build-commands": [
                "python3 ./setup.py sdist",
                "pip3 install dist/*.tar.gz"
            ]
        },

        {
            "name": "python-pyparsing",
            "buildsystem": "simple",
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "http://downloads.sourceforge.net/pyparsing/pyparsing-2.1.10.tar.gz",
                    "sha512": "21af73d6f479d52746f269c8fbaf90c1107a8aec756d30af8c7c4e6a2ff0ea9659cc07816b7ea19286bc12d43497f5e8e63351453bf18daf6a1cb380a195532e"
                }
            ],
            "build-commands": [
                "python3 ./setup.py sdist",
                "pip3 install dist/*.tar.gz"
            ]
        },

        {
            "name": "pdbpp-disabled",
            "ensure-writable": [
                "easy-install.pth"
            ],
            "buildsystem": "simple",
            "disabled": true,
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "build-commands": [
                "python3 ./setup.py sdist",
                "pip3 install dist/*.tar.gz"
            ],
            "sources": [
                {
                    "type": "git",
                    "branch": "0.9.2",
                    "url": "https://github.com/antocuni/pdb"
                }
            ]
        },

        {
            "name": "pdbpp",
            "ensure-writable": [
                "easy-install.pth"
            ],
            "buildsystem": "simple",
            "build-commands": [
                /* These are needed for the triggers */
                "/app/bin/python3 -m pip install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} fancycompleter wmctrl pygments pdbpp"
            ],
            "build-options": {
                /* This is an array containing extra options to pass to flatpak build. */
                "build-args": [
                    "--share=network",
                    "--allow=devel"
                ]
            },
            "sources": [
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/e6/cc/8bf81f5e53daa4a90d696fa430c2f4e709656e2bf953686bd15c0746616f/pdbpp-0.9.2.tar.gz",
                    "sha256": "dde77326e4ea41439c243ed065826d53539530eeabd1b6615aae15cfbb9fda05"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/71/2a/2e4e77803a8bd6408a2903340ac498cb0a2181811af7c9ec92cb70b0308a/Pygments-2.2.0.tar.gz",
                    "sha256": "dbae1046def0efb574852fab9e90209b23f556367b5a320c0bcb871c77c3e8cc"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/01/c6/001aefbde5782d6f359af0a8782990c3f4e751e29518fbd59dc8dfc58b18/wmctrl-0.3.tar.gz",
                    "sha256": "d806f65ac1554366b6e31d29d7be2e8893996c0acbb2824bbf2b1f49cf628a13"
                },
                {
                    "type": "file",
                    "url": "https://files.pythonhosted.org/packages/fd/e3/da39a6cfaffe578a01221261ac1d5d99c48d44f6377ff0de3a12dd332cec/fancycompleter-0.8.tar.gz",
                    "sha256": "d2522f1f3512371f295379c4c0d1962de06762eb586c199620a2a5d423539b12"
                }
            ]
        },

        {
            "name": "boost",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://dl.bintray.com/boostorg/release/1.64.0/source/boost_1_64_0.tar.bz2",
                    "sha256": "7bcc5caace97baa948931d712ea5f37038dbb1c5d89b43ad4def4ed7cb683332"
                }
            ],
            "build-commands": [
                "./bootstrap.sh",
                "./b2 headers",
                "cp -r boost /app/include/boost"
            ],
            "cleanup": [
                "*"
            ]
        },

        {
            "name": "swig",
            "cleanup": [
                "*"
            ],
            "build-options": {
                "build-args": [
                    "--share=network",
                    "--allow=devel",
                    "--filesystem=home:rw"
                ],
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "config-opts": [
                "--without-boost",
                "--without-pcre",
                "--with-python=python3"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://downloads.sourceforge.net/swig/swig-3.0.12.tar.gz",
                    "sha256": "7cf9f447ae7ed1c51722efc45e7f14418d15d7a1e143ac9f09a668999f4fc94d"
                }
            ]
        },

        {
            "name": "sphinxbase",
            "ensure-writable": [
                "easy-install.pth"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "git",
                    "branch": "74370799d5b53afc5b5b94a22f5eff9cb9907b97",
                    "url": "https://github.com/cmusphinx/sphinxbase.git"
                }
            ]
        },

        {
            "name": "pocketsphinx",
            "ensure-writable": [
                "easy-install.pth"
            ],
            "build-options": {
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app"
                }
            },
            "sources": [
                {
                    "type": "git",
                    "branch": "68ef5dc6d48d791a747026cd43cc6940a9e19f69",
                    "url": "https://github.com/cmusphinx/pocketsphinx.git"
                }
            ]
        },

        {
            "name": "tree",
            "no-autogen": true,
            "build-options": {
                /* This is an array containing extra options to pass to flatpak build. */
                "build-args": [
                    "--share=network",
                    "--allow=devel",
                    "--filesystem=home:rw"
                ],
                /* This is set in the environment variable CFLAGS during the build. Multiple specifications of this (in e.g. per-arch area) are concatenated, separated by spaces. */
                "cflags": "-ggdb -Wall -DLINUX -D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64",
                /* If this is true (the default is false) then all ELF files will be stripped after install. */
                "strip": false,
                /* By default (if strip is not true) flatpak-builder extracts all debug info in ELF files to a separate files and puts this in an extension. If you want to disable this, set no-debuginfo to true. */
                "no-debuginfo": false
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "http://mama.indstate.edu/users/ice/tree/src/tree-1.7.0.tgz",
                    "sha256": "6957c20e82561ac4231638996e74f4cfa4e6faabc5a2f511f0b4e3940e8f7b12"
                },
                {
                    "type": "patch",
                    "path": "tree-Makefile.patch"
                }
            ]
        },
        "scarlett-deps.json",
        {
            "name": "scarlett_os",
            "buildsystem": "simple",
            "build-commands": [
                "python3 ./setup.py sdist",
                "pip3 install dist/*.tar.gz"
            ],
            "ensure-writable": [
                "easy-install.pth",
                "setuptools.pth"
            ],
            "build-options": {
                "build-args": [
                    "--share=network",
                    "--allow=devel",
                    "--filesystem=home:rw"
                ],
                "cflags": "-O0 -g",
                "cxxflags": "-O0 -g",
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app",
                    "GST_PLUGIN_SYSTEM_PATH": "/app/lib/gstreamer-1.0/",
                    "GSTREAMER": "1.0",
                    "ENABLE_PYTHON3": "yes",
                    "ENABLE_GTK": "yes",
                    "PYTHON_VERSION": "3.5",
                    "MAKEFLAGS": "-j2 V=1",
                    "CC": "gcc",
                    "V": "1"
                },
                "strip": false,
                "no-debuginfo": false
            },
            "sources": [
                {
                    "type": "git",
                    "url": "git://github.com/bossjones/scarlett_os.git",
                    "branch": "master"
                },
                {
                    "type": "patch",
                    "path": "scarlett_os_package.py.patch"
                }
            ]
        },

        /* Neovim dependencies from third-party. Source: org.daa.NeovimGtk.json, note this libtool change is most likely very bad */
        {
            "name": "libtool",
            "sources": [
                {
                    "type": "archive",
                    "url": "http://ftpmirror.gnu.org/libtool/libtool-2.4.6.tar.gz",
                    "sha256": "e3bd4d5d3d025a36c21dd6af7ea818a2afcd4dfc1ea5a17b39d7854bcd0c06e3"
                }
            ]
        },
        {
            "name": "libuv",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/libuv/libuv/archive/v1.12.0.tar.gz",
                    "sha256": "41ce914a88da21d3b07a76023beca57576ca5b376c6ac440c80bc581cbca1250"
                }
            ]
        },
        {
            "name": "msgpack-c",
            "buildsystem": "cmake",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/msgpack/msgpack-c/archive/cpp-2.1.3.tar.gz",
                    "sha256": "42ff5c213fd24bd4388c45c1f21d84b476678ce6366ea4d4f4086618a1d2cd23"
                }
            ]
        },
        {
            "name": "LuaJIT",
            "buildsystem": "simple",
            "build-commands": [
                "sed -i \"s|/usr/local|/app|\" ./src/luaconf.h",
                "make",
                "make PREFIX=\"/app\" install"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/LuaJIT/LuaJIT/archive/82151a4514e6538086f3f5e01cb8d4b22287b14f.tar.gz",
                    "sha256": "8bc4e96ebab74e12ab84e751360e864714289bb089b51b6f396fa9a97df69798"
                }
            ]
        },
        {
            "name": "libvterm",
            "buildsystem": "simple",
            "build-commands": [
                "make",
                "make PREFIX=\"/app\" install"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/neovim/libvterm/archive/a9c7c6fd20fa35e0ad3e0e98901ca12dfca9c25c.tar.gz",
                    "sha256": "1a4272be91d9614dc183a503786df83b6584e4afaab7feaaa5409f841afbd796"
                }
            ]
        },
        {
            "name": "jemalloc",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/jemalloc/jemalloc/releases/download/4.5.0/jemalloc-4.5.0.tar.bz2",
                    "sha256": "9409d85664b4f135b77518b0b118c549009dc10f6cba14557d170476611f6780"
                }
            ]
        },
        {
            "name": "gperf",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnu.org/pub/gnu/gperf/gperf-3.1.tar.gz",
                    "sha256": "588546b945bba4b70b6a3a616e80b4ab466e3f33024a352fc2198112cdbb3ae2"
                }
            ]
        },
        {
            "name": "luarocks",
            "buildsystem": "simple",
            "build-commands": [
                "./configure --with-lua=/app --prefix=/app --lua-suffix=jit --with-lua-include=/app/include/luajit-2.0 --force-config",
                "make build",
                "make install"
            ],
            "build-options": {
                "strip": false,
                "no-debuginfo": true,
                "no-debuginfo-compression": true
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/luarocks/luarocks/archive/v2.4.2.tar.gz",
                    "sha256": "eef88c2429c715a7beb921e4b1ba571dddb7c74a250fbb0d3cc0d4be7a5865d9"
                }
            ]
        },
        {
            "name": "luarucks-mods",
            "buildsystem": "simple",
            "build-options": {
                "build-args": [
                    "--share=network"
                ]
            },
            "build-commands": [
                "luarocks build lpeg 1.0.1-1",
                "luarocks build mpack 1.0.6-0"
            ]
        },
        {
            "name": "neovim",
            "disabled": true,
            "buildsystem": "simple",
            "build-commands": [
                "make BUILD_TYPE=\"Unix Makefiles\" CMAKE_BUILD_TYPE=Release USE_BUNDLED_DEPS=OFF CMAKE_EXTRA_FLAGS=\"-DCMAKE_INSTALL_PREFIX=/app -DFEAT_TUI=OFF\" ",
                "make BUILD_TYPE=\"Unix Makefiles\" CMAKE_BUILD_TYPE=Release USE_BUNDLED_DEPS=OFF CMAKE_EXTRA_FLAGS=\"-DCMAKE_INSTALL_PREFIX=/app -DFEAT_TUI=OFF\" install"
            ],
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/neovim/neovim",
                    "tag": "v0.2.2"
                }
            ]
        },
        {
            "name": "vim",
            "disabled": false,
            "buildsystem": "simple",
            "build-commands": [
                "./configure --with-features=huge --enable-multibyte --enable-rubyinterp=no --enable-pythoninterp=yes --enable-python3interp=yes --with-python3-config-dir=/app/lib/python3.5/config --enable-perlinterp=yes --enable-luainterp=yes --enable-gui=gtk2 --enable-cscope --prefix=/app",
                "make VIMRUNTIMEDIR=/app/local/share/vim/vim80"
            ],
            "ensure-writable": [
                "easy-install.pth",
                "setuptools.pth"
            ],
            "build-options": {
                "build-args": [
                    "--share=network",
                    "--allow=devel",
                    "--filesystem=home:rw"
                ],
                "cflags": "-O0 -g",
                "cxxflags": "-O0 -g",
                "env": {
                    "PYTHON": "/app/bin/python3",
                    "PYTHONUSERBASE": "/app",
                    "GST_PLUGIN_SYSTEM_PATH": "/app/lib/gstreamer-1.0/",
                    "GSTREAMER": "1.0",
                    "ENABLE_PYTHON3": "yes",
                    "ENABLE_GTK": "yes",
                    "PYTHON_VERSION": "3.5",
                    "MAKEFLAGS": "-j2 V=1",
                    "CC": "gcc",
                    "V": "1"
                },
                "strip": false,
                "no-debuginfo": false
            },
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/vim/vim",
                    "tag": "v8.1.0026"
                }
            ]
        },

        {
        "name": "appdata_and_icons",
        "buildsystem": "simple",
        "build-commands": [
            "ls -lta",
            "env",
            "mkdir -p /app/share/metainfo/",
            "mkdir -p /app/share/appdata/",
            "mkdir -p /app/share/applications/",
            "mkdir -p /app/cache/scarlett/",
            "mkdir -p /app/share/icons/hicolor/64x64/apps/",
            "cp data/ScarlettOS.appdata.xml /app/share/metainfo/org.scarlett.ScarlettOS.appdata.xml",
            "cp data/icons/64x64/scarlettOS.png /app/share/icons/hicolor/64x64/apps/org.scarlett.ScarlettOS.png",
            "cp data/ScarlettOS.desktop /app/share/applications/org.scarlett.ScarlettOS.desktop"
        ],
        "sources": [
            {
                "type": "file",
                "path": "data/icons-install.sh",
                "dest-filename": "icons-install.sh"
            },
            {
                "type": "file",
                "path": "data/install-desktop-file.sh",
                "dest-filename": "install-desktop-file.sh"
            },
            {
                "type": "file",
                "path": "data/icons/64x64/scarlettOS.png"
            },
            {
                "type": "file",
                "path": "data/ScarlettOS.desktop",
                "dest-filename": "org.scarlett.ScarlettOS.desktop"
            },
            {
                "type": "file",
                "path": "data/ScarlettOS.appdata.xml",
                "dest-filename": "org.scarlett.ScarlettOS.appdata.xml"
            }
        ]
        }
    ]
}
